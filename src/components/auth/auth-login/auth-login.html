<link rel="import" href="../../../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../../../bower_components/iron-localstorage/iron-localstorage.html">
<link rel="import" href="../../../../../bower_components/brum-global-variable/brum-global-variable.html">

<link rel="import" href="auth-login.style.html">
<link rel="import" href="../../../state/redux-mixin.html">

<dom-module id="login-form">
    <template>
        <style include="login-form-styles"></style>

        <iron-localstorage name="user-storage" value="{{storedUser}}"></iron-localstorage>
        <brum-global-variable key="userData" value="{{storedUser}}"></brum-global-variable>

        <div>
            Loginform
            <button on-click="_login">Log in please!!!</button>
        </div>
    </template>

    <script>
        class AuthLoginForm extends App.ReduxMixin(Polymer.Element) {
            static get is() { return 'login-form'; }

            static get properties() {
                return {
                    storedUser: Object
                }
            }

            constructor() {
                super();
            }

            _login() {
                this.storedUser = {
                    loggedin: true
                };

                window.history.pushState({}, null, '/meals');
                window.dispatchEvent(new CustomEvent('location-changed'));
            }
        }

        window.customElements.define(AuthLoginForm.is, AuthLoginForm);
    </script>
</dom-module>